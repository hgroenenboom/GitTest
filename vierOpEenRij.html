<html>
    
    <style>
        svg {
            top: 7.5%;
            left: 7.5%;
            width: 85%;
            height: 85%;
            display: list-item;
            position: relative;
        }

        .cell {
            width: 0px;                 /*placeholder*/ 
            padding-bottom: 0px;        /*placeholder*/
            margin: 1px;
            background-color: lightcyan;
            display: inline-block;
        }

        #voer {
            width: 85%;
            left: 7.5%;
            height: 7.5vw;
            position: relative;
            background-color: grey;
        }
  </style>
    
    <head>
    </head>
    
    <body>
        <div>            
            <div id="voer"> 
                <h1>
                    X op een rij
                </h1>
                <p>
                    Een simpele X op een rij applicatie
                </p>

            </div>
        </div>
        
        <script type="text/javascript">

            // set number of Rows and Collums
            const DIMENSIONS = [12, 7];
            const NUMCELLS = DIMENSIONS[0] * DIMENSIONS[1];
    
            function Cell (htmldiv, position) {
                this.div = htmldiv;
                this.position = position;
                this.hasStone = false;
                this.ownedByPlayer = -1;

                var that = this;
                this.div.addEventListener("click", function(e) {
                    if(that.hasStone == false) {
                        if(that.onclick != null) {
                            that.onclick(that.position);
                        }
                    }
                });
                this.onclick = null;

                this.log = function() {
                    console.log("element", this.div);
                    console.log("position: ", this.position);
                }

                this.hasDrawn = function(){
                    return this.hasStone;
                }

                this.drawStone = function(playerNumber) {
                    this.ownedByPlayer = playerNumber;
                    const stoneColor = this.ownedByPlayer > 0 ? "red" : "blue"; 

                    /*<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                    width="1280.000000pt" height="854.000000pt" viewBox="0 0 1280.000000 854.000000"
                    preserveAspectRatio="xMidYMid meet">
                    <metadata>
                    Created by potrace 1.15, written by Peter Selinger 2001-2017
                    </metadata>
                    <g transform="translate(0.000000,854.000000) scale(0.100000,-0.100000)"
                    fill="#000000" stroke="none">
                    <path d="M7715 8529 c-324 -24 -711 -94 -1087 -195 -219 -59 -434 -126 -808
                    -255 -1003 -344 -1253 -413 -1555 -431 -206 -12 -726 -4 -1070 17 -137 9 -279
                    13 -315 9 -152 -15 -294 -84 -382 -183 -59 -68 -159 -235 -294 -492 -245 -467
                    -280 -532 -381 -700 -120 -201 -251 -388 -364 -521 -361 -424 -608 -887 -1059
                    -1983 -45 -110 -84 -202 -86 -204 -3 -3 -10 1 -16 7 -7 7 -15 12 -19 12 -8 0
                    -35 -78 -74 -217 -15 -51 -32 -105 -40 -120 -8 -16 -19 -59 -25 -98 -6 -38
                    -19 -95 -29 -125 -35 -105 -42 -136 -76 -359 l-35 -224 51 -171 c32 -107 59
                    -180 73 -196 12 -14 56 -79 96 -145 281 -458 480 -697 695 -838 89 -58 298
                    -177 311 -177 2 0 71 -33 153 -74 82 -41 151 -72 154 -70 3 3 22 -3 44 -14 21
                    -11 78 -34 127 -51 116 -41 501 -234 681 -341 77 -46 221 -138 320 -204 206
                    -139 279 -177 351 -184 102 -9 369 26 534 70 318 84 1192 371 1715 563 195 71
                    186 68 1095 300 338 87 930 238 1315 337 656 168 735 185 1255 284 695 131
                    948 193 1303 319 290 103 610 251 732 340 168 121 370 309 613 568 290 310
                    440 492 510 617 81 145 382 960 508 1375 156 514 187 757 135 1045 -32 182
                    -80 409 -90 428 -4 9 -34 94 -66 187 -45 131 -78 204 -141 316 -156 277 -254
                    430 -370 574 -74 93 -271 291 -280 282 -3 -3 -56 19 -117 48 -353 167 -1290
                    431 -2417 679 -807 178 -1183 224 -1575 195z"/>
                    </g>
                    </svg>*/

                    var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    svg.setAttribute("viewBox", "0 0 1280 854");
                    svg.setAttribute("preserveAspectRatio", "xMidYMid meet");
                    svg.setAttribute("version", "1.0");
                    svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");
                    
                    var g = document.createElementNS("http://www.w3.org/2000/svg", "g");
                    g.setAttribute("transform", "translate(0.000000,854.000000) scale(0.100000,-0.100000)");
                    g.setAttribute("fill", stoneColor);
                    g.setAttribute("stroke", "none");

                    var path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    path.setAttribute("d", `M7715 8529 c-324 -24 -711 -94 -1087 -195 -219 -59 -434 -126 -808
                    -255 -1003 -344 -1253 -413 -1555 -431 -206 -12 -726 -4 -1070 17 -137 9 -279
                    13 -315 9 -152 -15 -294 -84 -382 -183 -59 -68 -159 -235 -294 -492 -245 -467
                    -280 -532 -381 -700 -120 -201 -251 -388 -364 -521 -361 -424 -608 -887 -1059
                    -1983 -45 -110 -84 -202 -86 -204 -3 -3 -10 1 -16 7 -7 7 -15 12 -19 12 -8 0
                    -35 -78 -74 -217 -15 -51 -32 -105 -40 -120 -8 -16 -19 -59 -25 -98 -6 -38
                    -19 -95 -29 -125 -35 -105 -42 -136 -76 -359 l-35 -224 51 -171 c32 -107 59
                    -180 73 -196 12 -14 56 -79 96 -145 281 -458 480 -697 695 -838 89 -58 298
                    -177 311 -177 2 0 71 -33 153 -74 82 -41 151 -72 154 -70 3 3 22 -3 44 -14 21
                    -11 78 -34 127 -51 116 -41 501 -234 681 -341 77 -46 221 -138 320 -204 206
                    -139 279 -177 351 -184 102 -9 369 26 534 70 318 84 1192 371 1715 563 195 71
                    186 68 1095 300 338 87 930 238 1315 337 656 168 735 185 1255 284 695 131
                    948 193 1303 319 290 103 610 251 732 340 168 121 370 309 613 568 290 310
                    440 492 510 617 81 145 382 960 508 1375 156 514 187 757 135 1045 -32 182
                    -80 409 -90 428 -4 9 -34 94 -66 187 -45 131 -78 204 -141 316 -156 277 -254
                    430 -370 574 -74 93 -271 291 -280 282 -3 -3 -56 19 -117 48 -353 167 -1290
                    431 -2417 679 -807 178 -1183 224 -1575 195z`);
                    g.appendChild(path);

                    svg.appendChild(g);

                    this.div.appendChild(svg);
                    this.hasStone = true;
                }
            };

            var cells = [];


            /*  NIET FIREFOX COMPATIBLE:    CSSStyleRule.styleMap 
            // genereer Cell style:
            var cssRuleCode = document.all ? 'rules' : 'cssRules'; //account for IE and FF
            const styleSheet = document.styleSheets[0][cssRuleCode];
            const numRules = styleSheet.length;

            for(var i = 0; i < numRules; i++) {
                const rule = styleSheet[i];
                console.log(rule);
                if(rule.selectorText == ".cell") {
                    const rCollumns = 95 / numCollumns;
                    rule.styleMap.set("width", rCollumns + "%");
                    rule.styleMap.set("height", rCollumns + "vw");
                }
            }
            */ 
            
            // genereer Cellen en voeg deze toe aan de Cells array
            var voerContainer = document.getElementById("voer");
            var row = null;
            for(var i = 0; i < NUMCELLS; i++) {
                if(i % DIMENSIONS[0] == 0) {
                    cells[cells.length] = [];
                    row = document.createElement("div");
                    voerContainer.appendChild(row);
                }

                var newCell = document.createElement("div");
                newCell.className = "cell";
                const rCollumns = 90 / DIMENSIONS[0];
                newCell.style.setProperty("width", rCollumns + "%");
                newCell.style.setProperty("height", rCollumns + "vw");
                row.appendChild(newCell);

                cells[cells.length-1].push(new Cell(newCell, [ cells.length-1, i % DIMENSIONS[0] ] ));
            }



            function VOERMaintainer(cells, dimensions) {
                this.cells = cells;
                this.dimensions = dimensions;

                // switch oriÃ«ntation of cells
                var shiftedCells = [];
                for(var i = 0; i < this.dimensions[0]; i++) {
                    shiftedCells[i] = [];
                    for(var j = 0; j < this.dimensions[1]; j++) {
                        shiftedCells[i][j] = cells[j][i];
                    }
                }
                this.cells = shiftedCells;

                // register cell click events to handleclickevent
                var that = this;
                for(var i = 0; i < this.dimensions[0]; i++) {
                    for(var j = 0; j < this.dimensions[1]; j++) {
                        this.cells[i][j].onclick = function(pos) {
                            that.handleClickEvent(pos);
                        }
                    }
                }
                
                this.player1Turn = true;
                this.handleClickEvent = function(pos) {
                    this.dropStone(pos, player1Turn);
                    player1Turn = !player1Turn;
                }

                this.dropStone = function(pos, playersTurn) {
                    for(var i = this.dimensions[1]-1; i > -1 ; i--) {
                        if(!this.cells[pos[1]][i].hasDrawn()) {
                            this.cells[pos[1]][i].drawStone(playersTurn);
                            break;
                        }
                    }
                }
            }

            VOERMaintainer(cells, DIMENSIONS);

        </script>
    </body>
    
</html>